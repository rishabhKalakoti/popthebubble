/*
    Bling3D 1 Domain License (B301-01) TRIAL VERSION.
    Version 1.0 REV 1602241545
    Please purchase an appropriate license to use this software.
    License Agreement: www.starplugins.com/license
    Copyright (c)2012-2015 Star Plugins - www.starplugins.com
    
    Downloaded on Feb 22, 2019 by account #TRIAL USER
    License Key: N/A
    Licensed website(s): tedxmnitjaipur.com
*/
"use strict";"1.0 REV 1602241545";
Bling3D.Utils={removeEventListeners:function(a,b,c){b=b.split(" ");for(var d=0;d<b.length;d++)a.removeEventListener(b[d],c)},merge:function(a,b){Array.isArray(b)?a=[]:"object"!==typeof a&&(a={});for(var c in b)if(b.hasOwnProperty(c)){var d=b[c];a[c]="object"===typeof d?Bling3D.Utils.merge(a[c],d):d}return a},clone:function(a){return JSON.parse(JSON.stringify(a))},triggerEvent:function(a,b){if(document.createEvent){var c=document.createEvent("MouseEvents");c.initEvent(b,!0,!1);a.dispatchEvent(c)}else document.createEventObject&&
(c=document.createEventObject(),a.fireEvent("on"+b,c))},round:function(a){return Math.round(1E6*a)/1E6},snap:function(a,b){return Math.round(a/b)*b},easing:{easeOutQuad:function(a,b,c,d){return-c*(a/=d)*(a-2)+b},easeOutBack:function(a,b,c,d,f){void 0==f&&(f=1.70158);return c*((a=a/d-1)*a*((f+1)*a+f)+1)+b},easeOutBounce:function(a,b,c,d){return(a/=d)<1/2.75?7.5625*c*a*a+b:a<2/2.75?c*(7.5625*(a-=1.5/2.75)*a+.75)+b:a<2.5/2.75?c*(7.5625*(a-=2.25/2.75)*a+.9375)+b:c*(7.5625*(a-=2.625/2.75)*a+.984375)+b},
easeOutExpo:function(a,b,c,d){return a==d?b+c:c*(-Math.pow(2,-10*a/d)+1)+b},easeOutCirc:function(a,b,c,d){return c*Math.sqrt(1-(a=a/d-1)*a)+b},easeOutQuint:function(a,b,c,d){return c*((a=a/d-1)*a*a*a*a+1)+b}},worldToScreen:function(){return function(a,b,c,d,f){f=f||new THREE.Vector3;f.copy(a);f.project(b);f.x=(f.x+1)/2*c;f.y=-(f.y-1)/2*d;return f}}(),loadTexture:function(a,b){return 73>parseInt(THREE.REVISION)?THREE.ImageUtils.loadTexture(a,void 0,b):(new THREE.TextureLoader).load(a,b,function(a){console.log(a.loaded/
a.total*100+"% loaded")},function(a){console.log("Error loading texure:",a)})},iOSDetect:function(){var a=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return a}}(),prepend:function(a,b){return a.firstChild?a.insertBefore(b,a.firstChild):a.appendChild(b)},parseAngle:function(a){if("string"===typeof a){a=a.trim();var b=parseFloat(a);a=a.substr(a.length-3);if("deg"===a)return b*Math.PI/180;if("rad"===a)return b;a=b}return a*Math.PI/180},imagePower2:function(a,b){var c;c="nearest"===
(b||"nearest")?function(a){return Math.pow(2,Math.round(Math.log(a)/Math.LN2))}:THREE.Math.nextPowerOfTwo;if(a instanceof HTMLImageElement||a instanceof HTMLCanvasElement){var d=document.createElement("canvas");d.width=c(a.width);d.height=c(a.height);d.getContext("2d").drawImage(a,0,0,d.width,d.height);return d}return a},setFilter:function(a,b,c){b||(b="LinearMipMapLinearFilter");c||(c="LinearFilter");var d={NearestMipMapNearestFilter:!0,NearestMipMapLinearFilter:!0,"THREE.LinearMipMapNearestFilter":!0,
LinearMipMapLinearFilter:!0};THREE[b]&&THREE[c]?(!d[b]&&!d[c]||THREE.Math.isPowerOfTwo(a.image.width)&&THREE.Math.isPowerOfTwo(a.image.height)||(a.image=Bling3D.Utils.imagePower2(a.image),a.needsUpdate=!0),a.minFilter=THREE[b],a.magFilter=THREE[c]):console.warn("Bling3D: Cannot set filter, ",b,c)}};
Bling3D.GeneriCache={_cache:{},add:function(a,b){return this._cache[a]=b},remove:function(a){delete this._cache[a]},get:function(a){return this._cache[a]?this._cache[a]:null},reset:function(){this._cache={}}};
THREE.OrbitControls=function(a,b){function c(a){if(!1!==e.enabled){a.preventDefault();var b=e.domElement===document?e.domElement.body:e.domElement;if(m===k.ROTATE){if(!0===e.noRotate)return;h.set(a.clientX,a.clientY);n.subVectors(h,g);e.rotateLeft(2*Math.PI*n.x/b.clientWidth*e.rotateSpeed);e.rotateUp(2*Math.PI*n.y/b.clientHeight*e.rotateSpeed);g.copy(h)}else if(m===k.DOLLY){if(!0===e.noZoom)return;x.set(a.clientX,a.clientY);u.subVectors(x,z);0<u.y?e.dollyIn():e.dollyOut();z.copy(x)}else if(m===k.PAN){if(!0===
e.noPan)return;p.set(a.clientX,a.clientY);q.subVectors(p,r);e.pan(q.x,q.y);r.copy(p)}m!==k.NONE&&e.update()}}function d(){!1!==e.enabled&&(document.removeEventListener("mousemove",c,!1),document.removeEventListener("mouseup",d,!1),e.dispatchEvent(D),m=k.NONE)}function f(a){if(!1!==e.enabled&&!0!==e.noZoom&&m===k.NONE){a.preventDefault();a.stopPropagation();var b=0;void 0!==a.wheelDelta?b=a.wheelDelta:void 0!==a.detail&&(b=-a.detail);0<b?e.dollyOut():e.dollyIn();e.update();e.dispatchEvent(E);e.dispatchEvent(D)}}
this.object=a;this.domElement=void 0!==b?b:document;this.enabled=!0;this.center=this.target=new THREE.Vector3;this.noZoom=!1;this.zoomSpeed=1;this.minDistance=0;this.maxDistance=Infinity;this.noRotate=!1;this.rotateSpeed=1;this.noPan=!1;this.keyPanSpeed=7;this.autoRotate=!1;this.autoRotateSpeed=2;this.minPolarAngle=0;this.maxPolarAngle=Math.PI;this.minAzimuthAngle=-Infinity;this.maxAzimuthAngle=Infinity;this.noKeys=!1;this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,
ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};var e=this,g=new THREE.Vector2,h=new THREE.Vector2,n=new THREE.Vector2,r=new THREE.Vector2,p=new THREE.Vector2,q=new THREE.Vector2,v=new THREE.Vector3,l=new THREE.Vector3,z=new THREE.Vector2,x=new THREE.Vector2,u=new THREE.Vector2,y,t,A=0,w=0,B=1,C=new THREE.Vector3,F=new THREE.Vector3,G=new THREE.Quaternion,k={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},m=k.NONE;this.target0=this.target.clone();this.position0=this.object.position.clone();
var H=(new THREE.Quaternion).setFromUnitVectors(a.up,new THREE.Vector3(0,1,0)),I=H.clone().inverse(),J={type:"change"},E={type:"start"},D={type:"end"};this.rotateLeft=function(a){void 0===a&&(a=2*Math.PI/60/60*e.autoRotateSpeed);w-=a};this.rotateUp=function(a){void 0===a&&(a=2*Math.PI/60/60*e.autoRotateSpeed);A-=a};this.panLeft=function(a){var b=this.object.matrix.elements;v.set(b[0],b[1],b[2]);v.multiplyScalar(-a);C.add(v)};this.panUp=function(a){var b=this.object.matrix.elements;v.set(b[4],b[5],
b[6]);v.multiplyScalar(a);C.add(v)};this.pan=function(a,b){var c=e.domElement===document?e.domElement.body:e.domElement;if(void 0!==e.object.fov){var d=e.object.position.clone().sub(e.target).length(),d=d*Math.tan(e.object.fov/2*Math.PI/180);e.panLeft(2*a*d/c.clientHeight);e.panUp(2*b*d/c.clientHeight)}else void 0!==e.object.top?(e.panLeft(a*(e.object.right-e.object.left)/c.clientWidth),e.panUp(b*(e.object.top-e.object.bottom)/c.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")};
this.dollyIn=function(a){void 0===a&&(a=Math.pow(.95,e.zoomSpeed));B/=a};this.dollyOut=function(a){void 0===a&&(a=Math.pow(.95,e.zoomSpeed));B*=a};this.update=function(){var a=this.object.position;l.copy(a).sub(this.target);l.applyQuaternion(H);y=Math.atan2(l.x,l.z);t=Math.atan2(Math.sqrt(l.x*l.x+l.z*l.z),l.y);this.autoRotate&&m===k.NONE&&this.rotateLeft(2*Math.PI/60/60*e.autoRotateSpeed);y+=w;t+=A;y=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,y));t=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,
t));t=Math.max(1E-6,Math.min(Math.PI-1E-6,t));var b=l.length()*B,b=Math.max(this.minDistance,Math.min(this.maxDistance,b));this.target.add(C);l.x=b*Math.sin(t)*Math.sin(y);l.y=b*Math.cos(t);l.z=b*Math.sin(t)*Math.cos(y);l.applyQuaternion(I);a.copy(this.target).add(l);this.object.lookAt(this.target);A=w=0;B=1;C.set(0,0,0);if(1E-6<F.distanceToSquared(this.object.position)||1E-6<8*(1-G.dot(this.object.quaternion)))this.dispatchEvent(J),F.copy(this.object.position),G.copy(this.object.quaternion)};this.reset=
function(){m=k.NONE;this.target.copy(this.target0);this.object.position.copy(this.position0);this.update()};this.getPolarAngle=function(){return t};this.getAzimuthalAngle=function(){return y};this.domElement.addEventListener("contextmenu",function(a){a.preventDefault()},!1);this.domElement.addEventListener("mousedown",function(a){if(!1!==e.enabled){a.preventDefault();if(a.button===e.mouseButtons.ORBIT){if(!0===e.noRotate)return;m=k.ROTATE;g.set(a.clientX,a.clientY)}else if(a.button===e.mouseButtons.ZOOM){if(!0===
e.noZoom)return;m=k.DOLLY;z.set(a.clientX,a.clientY)}else if(a.button===e.mouseButtons.PAN){if(!0===e.noPan)return;m=k.PAN;r.set(a.clientX,a.clientY)}m!==k.NONE&&(document.addEventListener("mousemove",c,!1),document.addEventListener("mouseup",d,!1),e.dispatchEvent(E))}},!1);this.domElement.addEventListener("mousewheel",f,!1);this.domElement.addEventListener("DOMMouseScroll",f,!1);this.domElement.addEventListener("touchstart",function(a){if(!1!==e.enabled){switch(a.touches.length){case 1:if(!0===e.noRotate)return;
m=k.TOUCH_ROTATE;g.set(a.touches[0].pageX,a.touches[0].pageY);break;case 2:if(!0===e.noZoom)return;m=k.TOUCH_DOLLY;var b=a.touches[0].pageX-a.touches[1].pageX;a=a.touches[0].pageY-a.touches[1].pageY;z.set(0,Math.sqrt(b*b+a*a));break;case 3:if(!0===e.noPan)return;m=k.TOUCH_PAN;r.set(a.touches[0].pageX,a.touches[0].pageY);break;default:m=k.NONE}m!==k.NONE&&e.dispatchEvent(E)}},!1);this.domElement.addEventListener("touchend",function(){!1!==e.enabled&&(e.dispatchEvent(D),m=k.NONE)},!1);this.domElement.addEventListener("touchmove",
function(a){if(!1!==e.enabled){a.preventDefault();a.stopPropagation();var b=e.domElement===document?e.domElement.body:e.domElement;switch(a.touches.length){case 1:if(!0===e.noRotate)break;if(m!==k.TOUCH_ROTATE)break;h.set(a.touches[0].pageX,a.touches[0].pageY);n.subVectors(h,g);e.rotateLeft(2*Math.PI*n.x/b.clientWidth*e.rotateSpeed);e.rotateUp(2*Math.PI*n.y/b.clientHeight*e.rotateSpeed);g.copy(h);e.update();break;case 2:if(!0===e.noZoom)break;if(m!==k.TOUCH_DOLLY)break;b=a.touches[0].pageX-a.touches[1].pageX;
a=a.touches[0].pageY-a.touches[1].pageY;x.set(0,Math.sqrt(b*b+a*a));u.subVectors(x,z);0<u.y?e.dollyOut():e.dollyIn();z.copy(x);e.update();break;case 3:if(!0===e.noPan)break;if(m!==k.TOUCH_PAN)break;p.set(a.touches[0].pageX,a.touches[0].pageY);q.subVectors(p,r);e.pan(q.x,q.y);r.copy(p);e.update();break;default:m=k.NONE}}},!1);window.addEventListener("keydown",function(a){if(!1!==e.enabled&&!0!==e.noKeys&&!0!==e.noPan)switch(a.keyCode){case e.keys.UP:e.pan(0,e.keyPanSpeed);e.update();break;case e.keys.BOTTOM:e.pan(0,
-e.keyPanSpeed);e.update();break;case e.keys.LEFT:e.pan(e.keyPanSpeed,0);e.update();break;case e.keys.RIGHT:e.pan(-e.keyPanSpeed,0),e.update()}},!1);this.update()};THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);THREE.OrbitControls.prototype.constructor=THREE.OrbitControls;Bling3D.DomScan=function(){this.plugins={};this.features={};this.pluginCallStack=[]};Bling3D.DomScan.clean=function(a){a.bling3d&&delete a.bling3d;for(var b=0;b<a.children;b++)Bling3D.DomScan.clean(a.children[b])};
Bling3D.DomScan.prototype={capsFirst:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},addPlugin:function(a,b,c){a=Bling3D.dataNamespace+this.capsFirst(a);this.plugins[a]={name:a,defaults:Bling3D.Utils.clone(b),callback:c}},addFeature:function(a,b,c){a=Bling3D.dataNamespace+this.capsFirst(a);this.features[a]={name:a,defaults:Bling3D.Utils.clone(b),callback:c}},traverse:function(a){var b=a.dataset,c=!1,d;for(d in b)if(void 0!==this.plugins[d]){var f=this.plugins[d],e=Bling3D.Utils.clone(f.defaults),
g;try{g=eval("({"+b[d]+"})")}catch(n){console.error("Properties syntax error: "+b[d]);return}Bling3D.Utils.merge(e,g);var h=null;this.pluginCallStack.length&&(h=this.pluginCallStack[this.pluginCallStack.length-1]);c=f.callback(h,a,e);this.pluginCallStack.push(c);c=!0;Bling3D.dataNamespace+"AsDefault"in b&&Bling3D.Utils.merge(f.defaults,g)}g=a.children;for(f=0;f<g.length;f++)this.traverse(g[f]);for(d in b)void 0!==this.features[d]&&(f=this.features[d],"string"===typeof f.defaults?e=b[d]:(e=Bling3D.Utils.clone(f.defaults),
g=eval("({"+b[d]+"})"),Bling3D.Utils.merge(e,g)),h=null,this.pluginCallStack.length?h=this.pluginCallStack[this.pluginCallStack.length-1]:console.log("Cannot use feature: no plugin to apply it to."),f.callback(h,a,e));if(c)return this.pluginCallStack.pop()}};Bling3D.domScan=new Bling3D.DomScan;
Bling3D.Process=function(){this.parent=null;this.children=[];this.cachedSearches={};this.stopped=!1;this.processId=""+Bling3D.Process.processId++;Bling3D.Process.processList[""+this.processId]=this;this.userObject={};this.ready=!0};
Bling3D.Process.prototype={constructor:Bling3D.Process,type:"Bling3D.Process",update:function(){this.stopped||this.updateChildren()},updateChildren:function(){for(var a=0;a<this.children.length;a++)this.children[a].update()},add:function(a){this.clearSearchCache();this.children.push(a);a.parent=this},remove:function(a){this.clearSearchCache();var b=this.children.indexOf(a);-1!==b&&(a.parent=null,this.children.splice(b,1))},removeMe:function(){this.parent&&this.parent.remove(this)},destroy:function(){delete Bling3D.Process.processList[""+
this.processId];this.removeMe();this.userObject=null;for(var a=this.children,b=a.length-1;0<=b;b--)a[b].destroy()},stop:function(){this.stopped=!0},go:function(){this.stopped=!1},traverse:function(a){a(this);for(var b=0,c=this.children.length;b<c;b++)this.children[b].traverse(a)},searchByType:function(a,b){b||(b=[]);for(var c=0;c<this.children.length;c++)this.children[c].type===a&&b.push(this.children[c]),this.children[c].searchByType(a,b);return b},searchUpByType:function(a){return this.parent?this.parent.type===
a?this.parent:this.parent.searchUpByType(a):null},searchUpWhereParentIs:function(a){return this.parent?this.parent.type===a?this:this.parent.searchUpWhereParentIs(a):null},searchByTypeCached:function(a){var b="searchByType:"+a;this.cachedSearches[b]||(this.cachedSearches[b]=this.searchByType(a));return this.cachedSearches[b]},searchAnscestorByType:function(a){for(var b=this;b.parent;){if(b.parent.type==a)return b.parent;b=b.parent}return null},clearSearchCache:function(){this.cachedSearches={}}};
Bling3D.Process.extend=function(a,b,c){b.prototype=Object.create(a.prototype);for(var d in c)c.hasOwnProperty(d)&&("defineProperties"===d?Object.defineProperties(b.prototype,c[d]):b.prototype[d]=c[d]);b.prototype.constructor=b};Bling3D.Process.processId=0;Bling3D.Process.processList={};Bling3D.Process.getProcessById=function(a){return Bling3D.Process.processList[a]};Bling3D.Process3D=function(a){this.t3_obj=null;a.t3_obj&&(this.t3_obj=a.t3_obj,a.t3_parent&&a.t3_parent.add(this.t3_obj));Bling3D.Process.call(this)};
Bling3D.Process.extend(Bling3D.Process,Bling3D.Process3D,{type:"Bling3D.Process3D",destroy:function(){Bling3D.Process.prototype.destroy.call(this);this.t3ToThisRemove();Bling3D.Process3D.dispose(this.t3_obj);this.t3_obj.parent&&this.t3_obj.parent.remove(this.t3_obj);this.t3_obj=void 0},t3ToThis:function(){var a=this;this.t3_obj.traverse(function(b){Bling3D.Process3D.t3Objects[b.uuid]=a})},t3ToThisRemove:function(){this.t3_obj.traverse(function(a){delete Bling3D.Process3D.t3Objects[a.uuid]})},setNames:function(a,
b){a.traverse(function(a){a.name=b})}});Bling3D.Process3D.t3Objects={};Bling3D.Process3D.getProcessFromT3=function(a){return Bling3D.Process3D.t3Objects[a.uuid]};
Bling3D.Process3D.dispose=function(a){a.traverse(function(a){a.geometry&&a.geometry.dispose();if(a.material)if(a.material instanceof THREE.MeshFaceMaterial){a=a.material.materials;for(var b=0;b<a.length;b++)a[b].map&&a[b].map instanceof THREE.Texture&&a[b].map.dispose(),a[b].dispose()}else a.material.map&&a.material.map instanceof THREE.Texture&&a.material.map.dispose(),a.material.dispose()});for(var b=0;b<a.children.length;b++)a.remove(a.children[b]);a.parent&&a.parent.remove(a)};
Bling3D.Process3D.setPosRot=function(a,b){a.position.set(b.px,b.py,b.pz);var c=new THREE.Quaternion;c.multiply((new THREE.Quaternion).setFromEuler(new THREE.Euler(Bling3D.Utils.parseAngle(b.rx),0,0)));c.multiply((new THREE.Quaternion).setFromEuler(new THREE.Euler(0,Bling3D.Utils.parseAngle(b.ry),0)));c.multiply((new THREE.Quaternion).setFromEuler(new THREE.Euler(0,0,Bling3D.Utils.parseAngle(b.rz))));a.quaternion.copy(c)};
Bling3D.domScan.addPlugin("viewport",{clearColor:0,fogColor:0,fogNear:10,fogFar:20,defaultCamera:[0,0,5,0,0,-1],wakeTime:5,antialias:!0,forceAntialias:!1,pixelRatio:"auto",alpha:!1},function(a,b,c){a=new Bling3D.Viewport(b,c);a.userObject.element=b;a.wake(c.wakeTime);b=new Bling3D.EaseCamera({t3_parent:a.t3_scene,t3_camera:a.t3_camera});b.addCameraName("defaultCamera",c.defaultCamera);b.useCameraName("defaultCamera");b.setAnimTime(0);a.add(b);a.easeCamera=b;return a});
Bling3D.Viewport=function(a,b){var c;c=document.createElement("canvas");c.className+=" bling3d bling3d-canvas bling3d-webgl-true bling3d-reveal";a.appendChild(c);this.props=Bling3D.Utils.clone(b);this.canvasHeight=this.canvasWidth=0;this.canvasClientWidth;this.canvas=c;this.canvasWrap=a;this.wakeTime=b.wakeTime;this.easeCamera=null;c=this.t3_obj=new THREE.Scene;void 0!==b.fogColor&&(c.fog=Bling3D.Viewport.fogBug&&b.antialias?new THREE.Fog(b.fogColor,b.fogNear/4,b.fogFar/4):new THREE.Fog(b.fogColor,
b.fogNear,b.fogFar));this.t3_raycaster=new THREE.Raycaster;this.sleeping=!1;this.sleepCountdown=0;this.defaultCam=null;this.t3_camera=new THREE.PerspectiveCamera(60,this.canvasWidth/this.canvasHeight,.1,1E3);this.defaultAmbientLight=this.defaultDirectionalLight=null;this.createDefaultLights();this.t3_renderer=new THREE.WebGLRenderer({canvas:this.canvas,antialias:b.antialias,alpha:b.alpha,sortObjects:!0});c=1;var d=window.devicePixelRatio||1;"auto"===b.pixelRatio&&d?c=d:isNaN(b.pixelRatio)||(c=b.pixelRatio,
c>d&&(c=d));this.t3_renderer.setPixelRatio(c);b.antialias&&b.forceAntialias&&(this.t3_renderer.getContext().getContextAttributes().antialias||this.t3_renderer.setPixelRatio(c*b.forceAntialias));this.boundingClientRect={};this.resize();c=this.t3_renderer;c.setSize(this.canvasWidth,this.canvasHeight);c.setClearColor(b.clearColor);c.shadowMap.cullFace=THREE.CullFaceBack;c.shadowMap.type=THREE.PCFSoftShadowMap;this.t3_obj.add(this.t3_camera);this.allowSleep=!0;this.recalcBoundingClientRect=this.resizeMe=
!1;Bling3D.Process.call(this);this.imageLoader=(new Bling3D.ImageLoader).setCurrent();this.waitingForImages=!0};Bling3D.Viewport.init=function(a){a=Bling3D.domScan.traverse(a);a.callback("BLING3D_VIEWPORT_READY");Bling3D.Main.rootProcess.add(a)};
Bling3D.Process.extend(Bling3D.Process3D,Bling3D.Viewport,{type:"Bling3D.Viewport",update:function(){this.imageLoader.setCurrent();if(this.imageLoader.pending.length)this.imageLoader.update();else{if(this.waitingForImages){var a=this.userObject.element;Bling3D.removeSpinner(a);a.className+=" bling3d-reveal-setup";a.style.display="none";a.style.display="block";setTimeout(function(){a.className+=" bling3d-ready"},0);this.waitingForImages=!1}if(this.resizeMe)this.resize(),this.resizeMe=!1,this.updateChildren(),
this.t3_renderer.render(this.t3_obj,this.t3_camera);else if(this.recalcBoundingClientRect&&(this.boundingClientRect=this.canvasWrap.getBoundingClientRect(),this.recalcBoundingClientRect=!1),!this.sleeping){if(0<this.sleepCountdown&&this.allowSleep&&(this.sleepCountdown-=Bling3D.deltaT,0>=this.sleepCountdown)){this.sleeping=!0;Bling3D.callback("Bling3D.Viewport_SLEEP",this);return}this.updateChildren();this.t3_renderer.render(this.t3_obj,this.t3_camera)}}},destroy:function(){this.canvasWrap.removeChild(this.canvas);
this.imageLoader.destroy();Bling3D.Process3D.prototype.destroy.call(this)},createDefaultLights:function(){var a;this.defaultDirectionalLight=a=new THREE.DirectionalLight(8947848,1);a.position.set(0,100,100);this.t3_obj.add(a);this.defaultAmbientLight=a=new THREE.AmbientLight(8947848);this.t3_obj.add(a)},wake:function(a){void 0===a&&(a=this.wakeTime);this.sleepCountdown=a;this.sleeping=!1},resize:function(){var a=this.canvasWrap.getBoundingClientRect();this.boundingClientRect=a;this.canvasWidth=a.width;
this.canvasHeight=a.height;this.canvasClientWidth=this.canvas.clientWidth;this.t3_renderer.setSize(this.canvasWidth,this.canvasHeight);this.t3_camera.aspect=this.canvasWidth/this.canvasHeight;this.t3_camera.updateProjectionMatrix()},triggerEvent:function(a,b){Bling3D.Utils.triggerEvent(this.canvasWrap,a,b)},raycast:function(){var a=new THREE.Vector2;return function(b,c){var d,f;f=this.boundingClientRect;d=b-f.left;f=c-f.top;a.x=d/this.canvasWidth*2-1;a.y=2*-(f/this.canvasHeight)+1;this.t3_raycaster.setFromCamera(a,
this.t3_camera);return this.t3_raycaster.intersectObjects(this.t3_obj.children,!0)}}(),getIntersectedProcess:function(a,b){var c=this.raycast(a,b),d,f;for(f=0;f<c.length;f++)if(d=Bling3D.Process3D.getProcessFromT3(c[f].object))return d;return null}});
Bling3D.Viewport.checkFogBug=function(){var a=new THREE.Scene;a.fog=new THREE.Fog(16777215,1,2);var b=new THREE.PerspectiveCamera(75,1,.1,1E3),c=new THREE.WebGLRenderer({antialias:!0});c.setSize(32,32);var d=new THREE.PlaneGeometry(4,4),f=new THREE.MeshBasicMaterial({color:34816}),d=new THREE.Mesh(d,f);d.position.z=-2;a.add(d);c.render(a,b);a=c.getContext();b=new Uint8Array(4);a.readPixels(0,0,1,1,a.RGBA,a.UNSIGNED_BYTE,b);return 136===b[1]?!0:!1};Bling3D.Viewport.fogBug=Bling3D.Viewport.checkFogBug();
Bling3D.Callbacks.makeCaller(Bling3D.Viewport.prototype);
THREE.Mirror=function(a,b,c){THREE.Object3D.call(this);var d=c.material.toLowerCase();this.name="mirror_"+this.id;c=c||{};this.matrixNeedsUpdate=!0;var f=void 0!==c.textureWidth?c.textureWidth:512,e=void 0!==c.textureHeight?c.textureHeight:512;this.clipBias=void 0!==c.clipBias?c.clipBias:0;this.renderer=a;this.mirrorPlane=new THREE.Plane;this.normal=new THREE.Vector3(0,0,1);this.mirrorWorldPosition=new THREE.Vector3;this.cameraWorldPosition=new THREE.Vector3;this.rotationMatrix=new THREE.Matrix4;
this.lookAtPosition=new THREE.Vector3(0,0,-1);this.clipPlane=new THREE.Vector4;b instanceof THREE.PerspectiveCamera?this.camera=b:(this.camera=new THREE.PerspectiveCamera,console.log(this.name+": camera is not a Perspective Camera!"));this.textureMatrix=new THREE.Matrix4;this.mirrorCamera=this.camera.clone();this.mirrorCamera.matrixAutoUpdate=!0;this.texture=new THREE.WebGLRenderTarget(f,e,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,stencilBuffer:!1});a=THREE.UniformsUtils.clone(THREE.ShaderLib[d].uniforms);
b=("uniform mat4 textureMatrix;\nvarying vec4 mirrorCoord;\n"+THREE.ShaderLib[d].vertexShader).replace(THREE.ShaderChunk.shadowmap_vertex,THREE.ShaderChunk.shadowmap_vertex+"\nmirrorCoord = textureMatrix * (modelMatrix * vec4( position, 1.0 ));\n");var g=THREE.ShaderLib[d].fragmentShader.replace(THREE.ShaderChunk.logdepthbuf_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment+"\nuniform sampler2D mirrorSampler;\nuniform float mirrorOpacity;\nvarying vec4 mirrorCoord;\n").replace(THREE.ShaderChunk.map_fragment,
"diffuseColor = texture2DProj(mirrorSampler, mirrorCoord);\n");a=THREE.UniformsUtils.clone(THREE.ShaderLib[d].uniforms);a=THREE.UniformsUtils.merge([a,{mirrorSampler:{type:"t",value:null},textureMatrix:{type:"m4",value:new THREE.Matrix4},textureSampler:{type:"t",value:null},mirrorOpacity:{type:"f",value:c.opacity}}]);this.material=new THREE.ShaderMaterial({uniforms:a,vertexShader:b,fragmentShader:g,lights:"phong"===d||"lambert"===d,fog:!0,vertexColors:THREE.FaceColors,depthTest:!0,depthWrite:!1});
this.floorTexture=null;this.material.uniforms.mirrorSampler.value=this.texture;this.material.uniforms.textureMatrix.value=this.textureMatrix;THREE.Math.isPowerOfTwo(f)&&THREE.Math.isPowerOfTwo(e)||(this.texture.generateMipmaps=!1);this.updateTextureMatrix();this.render()};THREE.Mirror.prototype=Object.create(THREE.Object3D.prototype);THREE.Mirror.prototype.constructor=THREE.Mirror;
THREE.Mirror.prototype.updateTextureMatrix=function(){this.updateMatrixWorld();this.camera.updateMatrixWorld();this.mirrorWorldPosition.setFromMatrixPosition(this.matrixWorld);this.cameraWorldPosition.setFromMatrixPosition(this.camera.matrixWorld);this.rotationMatrix.extractRotation(this.matrixWorld);this.normal.set(0,0,1);this.normal.applyMatrix4(this.rotationMatrix);var a=this.mirrorWorldPosition.clone().sub(this.cameraWorldPosition);a.reflect(this.normal).negate();a.add(this.mirrorWorldPosition);
this.rotationMatrix.extractRotation(this.camera.matrixWorld);this.lookAtPosition.set(0,0,-1);this.lookAtPosition.applyMatrix4(this.rotationMatrix);this.lookAtPosition.add(this.cameraWorldPosition);var b=this.mirrorWorldPosition.clone().sub(this.lookAtPosition);b.reflect(this.normal).negate();b.add(this.mirrorWorldPosition);this.up.set(0,-1,0);this.up.applyMatrix4(this.rotationMatrix);this.up.reflect(this.normal).negate();this.mirrorCamera.position.copy(a);this.mirrorCamera.up=this.up;this.mirrorCamera.lookAt(b);
this.mirrorCamera.updateProjectionMatrix();this.mirrorCamera.updateMatrixWorld();this.mirrorCamera.matrixWorldInverse.getInverse(this.mirrorCamera.matrixWorld);this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);this.textureMatrix.multiply(this.mirrorCamera.projectionMatrix);this.textureMatrix.multiply(this.mirrorCamera.matrixWorldInverse);this.mirrorPlane.setFromNormalAndCoplanarPoint(this.normal,this.mirrorWorldPosition);this.mirrorPlane.applyMatrix4(this.mirrorCamera.matrixWorldInverse);
this.clipPlane.set(this.mirrorPlane.normal.x,this.mirrorPlane.normal.y,this.mirrorPlane.normal.z,this.mirrorPlane.constant);a=new THREE.Vector4;b=this.mirrorCamera.projectionMatrix;a.x=(Math.sign(this.clipPlane.x)+b.elements[8])/b.elements[0];a.y=(Math.sign(this.clipPlane.y)+b.elements[9])/b.elements[5];a.z=-1;a.w=(1+b.elements[10])/b.elements[14];var c=new THREE.Vector4,c=this.clipPlane.multiplyScalar(2/this.clipPlane.dot(a));b.elements[2]=c.x;b.elements[6]=c.y;b.elements[10]=c.z+1-this.clipBias;
b.elements[14]=c.w};THREE.Mirror.prototype.render=function(){this.matrixNeedsUpdate&&this.updateTextureMatrix();this.matrixNeedsUpdate=!0;for(var a=this;null!==a.parent;)a=a.parent;if(void 0!==a&&a instanceof THREE.Scene){for(var b in Bling3D.MirrorFloor.excludeObjects)Bling3D.MirrorFloor.excludeObjects[b].visible=!1;this.renderer.render(a,this.mirrorCamera,this.texture,!0);for(b in Bling3D.MirrorFloor.excludeObjects)Bling3D.MirrorFloor.excludeObjects[b].visible=!0}};
Bling3D.domScan.addPlugin("mirrorFloor",{opacity:.5,src:null,imageRepeatX:1,imageRepeatY:1,color:16777215,material:"basic"},function(a,b,c){var d;d=Bling3D.ImageTile.getImg(b);c.element=b;c=new Bling3D.MirrorFloor(d,c,a.t3_obj,a.t3_renderer,a.t3_camera);a.add(c);c.userObject.element=b;return c});Bling3D.domScan.addFeature("noReflection",{},function(a,b,c){Bling3D.MirrorFloor.exclude(a.t3_obj)});
Bling3D.MirrorFloor=function(a,b,c,d,f){var e=this;this.groundMirror=null;this.t3_renderer=d;this.t3_camera=f;this.props=Bling3D.Utils.clone(b);Bling3D.Process3D.call(this,{t3_obj:new THREE.Object3D,t3_parent:c});a||b.src?Bling3D.ImageTile.loadImage(a,b,function(a){e.setup(a)}):e.setup()};
Bling3D.Process.extend(Bling3D.Process3D,Bling3D.MirrorFloor,{type:"MirrorFloor",setup:function(a){var b=this.props,c,d;c=new THREE.PlaneGeometry(50,50);for(var f={transparent:1>b.opacity,opacity:b.opacity,color:b.color},e=0;e<c.faces.length;e++)c.faces[e].color.set(b.color);a&&(Bling3D.Utils.setFilter(a),f.map=a,Bling3D.ImageTile.setRepeat(f.map,b));"basic"===b.material?d=new THREE.MeshBasicMaterial(f):"lambert"===b.material?d=new THREE.MeshLambertMaterial(f):"phong"===b.material&&(d=new THREE.MeshPhongMaterial(f));
a=new THREE.Mesh(c,d);a.renderOrder=-1;1>b.opacity&&(this.groundMirror=b=new THREE.Mirror(this.t3_renderer,this.t3_camera,{clipBias:.003,textureWidth:1024,textureHeight:1024,opacity:1,imagex:b.image,material:"basic",imageRepeatX:b.imageRepeatX,imageRepeatY:b.imageRepeatY}),c=new THREE.Mesh(c,b.material),c.add(b),a.add(c),c.renderOrder=-2,Bling3D.MirrorFloor.exclude(c));Bling3D.MirrorFloor.exclude(a);a.rotateX(-Math.PI/2);this.t3_obj.add(a);this.groundMirror&&this.groundMirror.render()},update:function(){this.groundMirror&&
this.groundMirror.render()},destroy:function(){this.t3_renderer=void 0;Bling3D.MirrorFloor.excludeObjects={};this.groundMirror&&this.groundMirror.texture.dispose();Bling3D.Process3D.prototype.destroy.call(this)}});Bling3D.MirrorFloor.excludeObjects={};Bling3D.MirrorFloor.exclude=function(a){Bling3D.MirrorFloor.excludeObjects[a.uuid]=a};Bling3D.domScan.addPlugin("colorDome",{topColor:"white",bottomColor:"black"},function(a,b,c){a=new Bling3D.ColorDome(a,c);a.userObject.element=b;return a});
Bling3D.ColorDome=function(a,b){var c={topColor:{type:"c",value:new THREE.Color(b.topColor)},bottomColor:{type:"c",value:new THREE.Color(b.bottomColor)},offset:{type:"f",value:0},exponent:{type:"f",value:1}},d=new THREE.SphereGeometry(50,8,8),c=new THREE.ShaderMaterial({uniforms:c,vertexShader:"varying vec3 vWorldPosition;\nvoid main() {\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\nvWorldPosition = worldPosition.xyz;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",
fragmentShader:"uniform vec3 topColor;\nuniform vec3 bottomColor;\nuniform float offset;\nuniform float exponent;\nvarying vec3 vWorldPosition;\nvoid main() {\nfloat h = normalize( vWorldPosition + offset ).y;\ngl_FragColor = vec4( mix( bottomColor, topColor, max( pow( max( h, 0.0 ), exponent ), 0.0 ) ), 1.0 );\n}",side:THREE.BackSide,depthWrite:!1}),d=new THREE.Mesh(d,c);d.renderOrder=-999;Bling3D.Process3D.call(this,{t3_parent:a.t3_obj,t3_obj:d});a.add(this)};
Bling3D.Process.extend(Bling3D.Process3D,Bling3D.ColorDome,{type:"Bling3D.ColorDome",update:function(){this.t3_obj.position.copy(this.parent.t3_camera.position);this.updateChildren()}});Bling3D.Path=function(a,b){this.threePath=null;this.closedPath=!1;if(void 0===this[a])console.error("Unknown path type:"+a);else this[a](b)};
Bling3D.Path.placeOnPath=function(){var a=new THREE.Vector3(0,1,0),b=new THREE.Matrix4,c=new THREE.Vector3;return function(d,f,e,g){0>f&&(f=0);1<f&&(f=1);e.copy(d.getPointAt(f));d=d.getTangent(f);b.lookAt(d,c,a);g.setFromRotationMatrix(b)}}();
Bling3D.Path.prototype={constructor:Bling3D.Path,placeOnPath:function(a,b,c){Bling3D.Path.placeOnPath(this.threePath,a,b,c)},oval:function(a){for(var b=[],c=Math.PI,d=0;100>d;d++)b.push(new THREE.Vector3(Math.sin(c)*a.pts[0],0,Math.cos(c)*a.pts[1])),c+=2*Math.PI/100;this.threePath=new THREE.CatmullRomCurve3(b);this.closedPath=this.threePath.closed=!0},closedCurve:function(a){this.threePath=new THREE.CatmullRomCurve3(a.pts);this.closedPath=this.threePath.closed=!0},openCurve:function(a){this.threePath=
new THREE.CatmullRomCurve3(a.pts);this.closedPath=!1},line:function(a){this.threePath=new THREE.LineCurve3(a.pts[0],a.pts[1]);this.closedPath=!1},visualize:function(a){for(var b=new THREE.LineBasicMaterial({color:65280}),c=new THREE.Geometry,d=this.threePath.getPoints(100),f=0;f<d.length;f++)c.vertices.push(d[f]);b=new THREE.Line(c,b);a.add(b)}};"use strict";
Bling3D.domScan.addPlugin("imageTile",{frameColor:0,depth:0,shadowPath:"",originY:0,maxWidth:1,maxHeight:1,px:0,py:0,pz:0,rx:0,ry:0,rz:0,crossOrigin:null,textAttribute:"",textCanvas:{},textVerticalPos:"bottom"},function(a,b,c){c.scene=a.t3_obj;var d=Bling3D.ImageTile.getImg(b);c.text=d?d.getAttribute(c.textAttribute):b.getAttribute(c.textAttribute);c.element=b;c.img=d;d=new Bling3D.ImageTile(c);Bling3D.Process3D.setPosRot(d.t3_obj,c);d.userObject.element=b;a.add(d);return d});
Bling3D.ImageTile=function(a){var b=this;this.props=a;this.cameraPoint=null;this.curve=a.curve;this.item=null;this.originX=a.originX||0;this.originY=a.originY||0;this.originZ=a.originZ||0;this.maxWidth=a.maxWidth;this.maxHeight=a.maxHeight;this.depth=a.depth;this.imageItem=null;Bling3D.Process3D.call(this,a);this.ready=!1;this.t3_obj=new THREE.Object3D;this.t3ToThis();this.texture=null;this.tileRoot=new THREE.Object3D;this.t3_obj.add(this.tileRoot);this.shad=null;if(""!==a.shadowPath){var c=Bling3D.GeneriCache.get("ShadowGeom");
c||(c=Bling3D.GeneriCache.add("ShadowGeom",new THREE.PlaneBufferGeometry(1,1)));var d=Bling3D.GeneriCache.get(a.shadowPath);d||(this.shadowTexture=Bling3D.ImageLoader.getCurrent().load(a.shadowPath),d=Bling3D.GeneriCache.add(a.shadowPath,new THREE.MeshBasicMaterial({map:this.shadowTexture,depthTest:!0,color:0,transparent:!0,opacity:.4})));this.shad=c=new THREE.Mesh(c,d);c.rotation.x=-Math.PI/2;c.position.y=.001;b.tileRoot.add(c)}this.texture=Bling3D.ImageTile.loadImage(a.img,a,function(a){b.setup(a.image.naturalWidth,
a.image.naturalHeight);Bling3D.Utils.setFilter(a)})};Bling3D.ImageTile.loadImage=function(a,b,c){if(b.src)return a=Bling3D.ImageLoader.getCurrent().load(b.src,c,b.srcset);if(!a)return console.warn("Bling3D: No <img> element or src found."),null;b.crossOrigin?(b=a.getAttribute("srcset"),a=Bling3D.ImageLoader.getCurrent().load(a.src,c,b)):a=Bling3D.ImageLoader.getCurrent().load(a,c);return a};Bling3D.ImageTile.getImg=function(a){return"IMG"!==a.nodeName?a.querySelector("img"):a};
Bling3D.ImageTile.setRepeat=function(a,b){var c=b.imageRepeatX,d=b.imageRepeatY;c&&d&&(a.wrapS=a.wrapT=THREE.RepeatWrapping,a.repeat.set(c,d))};
Bling3D.Process.extend(Bling3D.Process3D,Bling3D.ImageTile,{type:"Bling3D.ImageTile",destroy:function(){Bling3D.Process3D.prototype.destroy.call(this)},visualize:function(){var a=new THREE.SphereGeometry(.2),b=new THREE.MeshLambertMaterial({color:65280});this.cameraPoint.add(new THREE.Mesh(a,b));b=new THREE.MeshLambertMaterial({color:16711935});this.lookPoint.add(new THREE.Mesh(a,b))},setup:function(a,b){var c,d,f,e;d=a;var g=b;e=Math.min(this.maxWidth/a,this.maxHeight/b);a*=e;b*=e;this.canvas=document.createElement("canvas");
this.canvas.width=d;this.canvas.height=g;this.ctx=this.canvas.getContext("2d");this.ctx.drawImage(this.texture.image,0,0,d,g);this.texture.image=this.canvas;this.texture.needsUpdate=!0;d=new THREE.MeshLambertMaterial({alphaTest:.5,map:this.texture,transparent:!0});Bling3D.ImageTile.setRepeat(d.map,this.props);if(0<this.depth){e=new THREE.Color(this.props.frameColor);c=e.getHexString();(g=Bling3D.GeneriCache.get(c))||(g=Bling3D.GeneriCache.add(c,new THREE.MeshLambertMaterial({color:e})));e=Bling3D.GeneriCache.get("BoxGeom");
if(!e){e=Bling3D.GeneriCache.add("BoxGeom",new THREE.BoxGeometry(1,1,1));for(c=0;8>c;c++)f=e.faces[c],f.materialIndex=0;for(;12>c;c++)f=e.faces[c],f.materialIndex=1}d=[g,d]}else e=Bling3D.GeneriCache.get("imageTilePlaneGeom"),e||(e=Bling3D.GeneriCache.add("imageTilePlaneGeom",new THREE.PlaneGeometry(1,1)),e.merge(e,(new THREE.Matrix4).makeRotationY(Math.PI))),d=[d];d=this.imageItem=new THREE.Mesh(e,new THREE.MeshFaceMaterial(d));d.position.set(this.originX*-(a/2),this.originY*-(b/2),this.originZ*
-(this.depth/2));d.scale.set(a,b,this.depth||1);this.tileRoot.add(d);this.props.scene.add(this.t3_obj);this.shad&&this.shad.scale.set(1.3*a,(this.depth||.01)+.2,1);this.ready=!0;this.t3ToThis();this.props.text&&""!==this.props.text&&this.addTextCanvas(this.canvas,this.ctx)},addTextCanvas:function(a,b){var c=Bling3D.Utils.clone(this.props.textCanvas);c.width=a.width;c=Bling3D.FlatText.createCanvasText(this.props.text,c);"bottom"===this.props.textVerticalPos?b.drawImage(c,0,a.height-c.height):b.drawImage(c,
0,0)}});Bling3D.Callbacks.makeCaller(Bling3D.ImageTile.prototype);"use strict";Bling3D.domScan.addPlugin("canvasTile",{frameColor:0,depth:0,shadowPath:"",originY:0,maxWidth:1,maxHeight:1,px:0,py:0,pz:0,rx:0,ry:0,rz:0},function(a,b,c){c.scene=a.t3_obj;c.element=b;var d=new Bling3D.CanvasTile(c);Bling3D.Process3D.setPosRot(d.t3_obj,c);d.userObject.element=b;a.add(d);return d});
Bling3D.CanvasTile=function(a){this.data=this.props=a;this.item=null;this.originX=a.originX||0;this.originY=a.originY||0;this.originZ=a.originZ||0;this.maxWidth=a.maxWidth;this.maxHeight=a.maxHeight;this.depth=a.depth;this.imageItem=null;Bling3D.Process3D.call(this,a);this.t3_obj=new THREE.Object3D;this.t3ToThis();this.texture=null;this.tileRoot=new THREE.Object3D;this.t3_obj.add(this.tileRoot);this.shad=null;if(""!==a.shadowPath){var b=Bling3D.GeneriCache.get("ShadowGeom");b||(b=Bling3D.GeneriCache.add("ShadowGeom",
new THREE.PlaneBufferGeometry(1,1)));var c=Bling3D.GeneriCache.get(a.shadowPath);c||(this.shadowTexture=Bling3D.ImageLoader.getCurrent().load(a.shadowPath),c=Bling3D.GeneriCache.add(a.shadowPath,new THREE.MeshBasicMaterial({map:this.shadowTexture,depthTest:!0,color:0,transparent:!0,opacity:.4})));this.shad=b=new THREE.Mesh(b,c);b.rotation.x=-Math.PI/2;b.position.y=.001;this.tileRoot.add(b)}this.texture=new THREE.Texture(a.element);this.texture.image=a.element;this.setup(a.element.width,a.element.height);
Bling3D.Utils.setFilter(this.texture)};
Bling3D.Process.extend(Bling3D.Process3D,Bling3D.CanvasTile,{type:"Bling3D.CanvasTile",refresh:function(){this.texture.needsUpdate=!0},setup:function(a,b){var c,d,f,e;a=this.maxWidth;b=this.maxHeight;d=new THREE.MeshBasicMaterial({map:this.texture,transparent:!1,wireframe:!1});Bling3D.ImageTile.setRepeat(d.map,this.props);this.material=d;if(0<this.depth){e=new THREE.Color(this.data.frameColor);c=e.getHexString();var g=Bling3D.GeneriCache.get(c);g||(g=Bling3D.GeneriCache.add(c,new THREE.MeshLambertMaterial({color:e})));
e=Bling3D.GeneriCache.get("BoxGeom");if(!e){e=Bling3D.GeneriCache.add("BoxGeom",new THREE.BoxGeometry(1,1,1));for(c=0;8>c;c++)f=e.faces[c],f.materialIndex=0;for(;12>c;c++)f=e.faces[c],f.materialIndex=1}d=[g,d]}else e=Bling3D.GeneriCache.get("imageTilePlaneGeom"),e||(e=Bling3D.GeneriCache.add("imageTilePlaneGeom",new THREE.PlaneGeometry(1,1)),e.merge(e,(new THREE.Matrix4).makeRotationY(Math.PI))),d=[d];d=this.imageItem=new THREE.Mesh(e,new THREE.MeshFaceMaterial(d));d.position.set(this.originX*-(a/
2),this.originY*-(b/2),this.originZ*-(this.depth/2));d.scale.set(a,b,this.depth||1);this.tileRoot.add(d);this.data.scene.add(this.t3_obj);this.shad&&this.shad.scale.set(1.3*a,(this.depth||.01)+.2,1);this.t3ToThis();this.data.text&&""!==this.data.text&&this.addTextCanvas(this.canvas,this.ctx)}});Bling3D.Callbacks.makeCaller(Bling3D.CanvasTile.prototype);
Bling3D.PathCam=function(a){a.obj3D=new THREE.Object3D;this.path=a.path;this.camera=a.camera;this.startTime=Bling3D.clock.getElapsedTime();this.camMount=new THREE.Object3D;this.destZ=(new THREE.Vector3).copy(this.camMount.position);this.startZ=(new THREE.Vector3).copy(this.camMount.position);this.item=new THREE.Object3D;a.obj3D.add(this.item);this.item.add(this.camMount);this.destQ=new THREE.Quaternion;this.startQ=new THREE.Quaternion;this.t=0;this.startT;this.destT;Bling3D.Process3D.call(this,a);
this.visualize()};
Bling3D.Process.extend(Bling3D.Process3D,Bling3D.PathCam,{moveTo:function(a,b,c){this.destT=a;this.startT=this.t;this.startTime=Bling3D.clock.getElapsedTime();this.destZ.copy(b);this.startZ.copy(this.camMount.position);this.camera&&(this.startQ.copy(this.camera.quaternion),this.destQ.copy(c))},visualize:function(){var a=new THREE.SphereGeometry(.5),b=new THREE.MeshLambertMaterial({color:16776960});this.obj3D.add(new THREE.Mesh(a,b));b=new THREE.ArrowHelper(new THREE.Vector3(0,0,1),new THREE.Vector3(0,
0,0),4,16711680);this.obj3D.add(b);b=new THREE.MeshLambertMaterial({color:16711680});this.camMount.add(new THREE.Mesh(a,b));b=new THREE.MeshLambertMaterial({color:16711935});a=new THREE.BoxGeometry(1,2,.25);this.item.add(new THREE.Mesh(a,b))},update:function(){var a=Bling3D.clock.getElapsedTime()-this.startTime;1<a&&(a=1);a=easeOutQuad(a,0,1,1);this.t=this.startT;this.t+=(this.destT-this.t)*a;var b=this.t%1;0>b&&(b=1+b);this.path.placeOnPath(b,this.obj3D.position,this.obj3D.quaternion);this.camMount.position.copy(this.startZ);
this.camMount.position.lerp(this.destZ,a);this.obj3D.updateMatrixWorld(!0);this.camera&&(this.camera.quaternion.copy(this.startQ),this.camera.quaternion.slerp(this.destQ,a),this.camera.position.setFromMatrixPosition(this.camMount.matrixWorld))}});
Bling3D.domScan.addPlugin("pathSlider",{path:"oval",points:[3,3],itemRotation:{x:0,y:0,z:0},looping:!0,firstBound:1E99,lastBound:-1E99,primaryOffset:.5,cameraName:"defaultCamera",debug:!1,swipeDirection:"horizontal",swipeSpeed:"0.4",swipeMomentumSpeed:"0.2",moveToPrimary:!1,px:0,py:0,pz:0,rx:0,ry:0,rz:0,spacing:"auto"},function(a,b,c){c=Bling3D.Utils.clone(c);var d=new Bling3D.PathSlider({itemSpacing:c.spacing,t3_parent:a.t3_obj,animFunc:null,primaryOffset:c.primaryOffset,cameraName:c.cameraName,
swipeDirection:c.swipeDirection,swipeSpeed:c.swipeSpeed,swipeMomentumSpeed:c.swipeMomentumSpeed,moveToPrimary:c.moveToPrimary});d.props=c;a.addCallback("BLING3D_VIEWPORT_READY",d,"vpReady");d.userObject.element=b;var f;switch(c.path){case "oval":if(2!==c.points.length){console.error("Oval requires width and depth values.");return}f={pts:[c.points[0],c.points[1]]};break;case "line":if(6!==c.points.length){console.error("Line requires start and end points.");return}case "closedCurve":case "openCurve":for(f=
{pts:[]},b=0;b<c.points.length;b+=3)f.pts.push(new THREE.Vector3(c.points[b],c.points[b+1],c.points[b+2]))}d.path=new Bling3D.Path(c.path,f);c.debug&&(d.debug=!0,d.path.visualize(d.t3_obj));d.itemRotation=c.itemRotation;a.add(d);Bling3D.Process3D.setPosRot(d.t3_obj,c);return d});
Bling3D.PathSlider=function(a){a.t3_obj=new THREE.Object3D;this.cameraName=a.cameraName;this.path=null;this.debug=!1;this.startOffset=this.startTime=this.pathOffsetDest=this.pathOffset=0;this.angleOffset=new THREE.Euler;this.swipeDirection=a.swipeDirection||"horizontal";this.swipeSpeed=a.swipeSpeed||.4;this.swipeMomentumSpeed=a.swipeMomentumSpeed||.2;this.moveToPrimary=a.moveToPrimary;this.loopItems=this.moving=this.focused=!1;this.itemSpacing=a.itemSpacing;a.angleOffset&&this.angleOffset.copy(a.angleOffset);
this.animFunc=a.animFunc;this.primaryOffset=a.primaryOffset;this.angleOffset=new THREE.Quaternion;this._minOffset=Number.NEGATIVE_INFINITY;this._maxOffset=Number.POSITIVE_INFINITY;this.prevItemNearOffset=-1;Bling3D.Process3D.call(this,a)};
Bling3D.Process.extend(Bling3D.Process3D,Bling3D.PathSlider,{type:"Bling3D.PathSlider",vpReady:function(){var a=this.props,b=this.children,c=Bling3D.Utils.round(1/b.length);"auto"!==a.spacing&&0<a.spacing&&(c=a.spacing);this.itemSpacing=c;this.loopItems=a.looping;this.setPathBounds(a.firstBound,a.lastBound,b.length);this.moveItemTo(0,a.primaryOffset,!0)},defineProperties:{minOffset:{get:function(){return this._minOffset},set:function(a){this._minOffset=Bling3D.Utils.round(a)}},maxOffset:{get:function(){return this._maxOffset},
set:function(a){this._maxOffset=Bling3D.Utils.round(a)}},itemRotation:{set:function(a){this.angleOffset=new THREE.Quaternion;a.x&&this.angleOffset.multiply((new THREE.Quaternion).setFromEuler(new THREE.Euler(Bling3D.Utils.parseAngle(a.x),0,0)));a.y&&this.angleOffset.multiply((new THREE.Quaternion).setFromEuler(new THREE.Euler(0,Bling3D.Utils.parseAngle(a.y),0)));a.z&&this.angleOffset.multiply((new THREE.Quaternion).setFromEuler(new THREE.Euler(0,0,Bling3D.Utils.parseAngle(a.z))))}}},destroy:function(){Bling3D.Process3D.prototype.destroy.call(this)},
clampPathOffset:function(a,b){b=Bling3D.Utils.round(b);1>b&&(b=1);a=Bling3D.Utils.round(a%=b);0>a&&(a+=b);return a},getOffset:function(a,b){return b-a*this.itemSpacing},getItemNearestCamera:function(a){var b=this.searchByTypeCached("Bling3D.ImageTile"),c,d,f,e,g,h;g=(new THREE.Vector3).set(0,0,-1).applyQuaternion(a.quaternion);c=b.length;var n=(new THREE.Vector3).setFromMatrixPosition(a.matrixWorld),r=new THREE.Vector3;f=Number.POSITIVE_INFINITY;h="";for(var p=0;p<c;p++){a=b[p];r.setFromMatrixPosition(a.t3_obj.matrixWorld);
e=new THREE.Vector3;e.copy(r);e.sub(n);e.normalize();var q=e.dot(g);e=r.distanceTo(n)*(.1/(q/1));h+=p+1+" "+e.toFixed(3)+" "+q.toFixed(3)+"</br>";!(0>q)&&e<f&&(f=e,d=a)}d&&(h+=d.data.imagePath);$("#info").html(h);return d},getItemOffset:function(a){var b=this.children.length;a=items.indexOf(a);return Bling3D.Utils.round(this.clampPathOffset(a*this.itemSpacing+this.pathOffset,b*this.itemSpacing))},getItemNearOffset:function(a){a=this.clampPathOffset(a-this.pathOffset+this.itemSpacing/2,this.children.length*
this.itemSpacing);return this.children[Math.floor(a/this.itemSpacing)]},getPrimaryItem:function(){return this.getItemNearOffset(this.primaryOffset)},setPathBounds:function(a,b,c){this.maxOffset=a;this.minOffset=-((c-1)*this.itemSpacing-b)},checkExtents:function(a){a<=this.minOffset&&(a=this.minOffset);a>=this.maxOffset&&(a=this.maxOffset);return a},move:function(a){a=Bling3D.Utils.round(this.pathOffsetDest+this.itemSpacing*a);var b=this.checkExtents(a);b===a&&(this.startTime=Bling3D.clock.getElapsedTime(),
this.pathOffsetDest=b,this.startOffset=this.pathOffset)},slide:function(a){this.pathOffsetDest=this.pathOffset=this.checkExtents(Bling3D.Utils.round(this.pathOffset+a));this.startTime=0},endSlide:function(a){this.pathOffsetDest=this.pathOffset+a;this.pathOffsetDest=Bling3D.Utils.round(Bling3D.Utils.snap(this.pathOffsetDest-this.primaryOffset,this.itemSpacing))+this.primaryOffset;this.pathOffsetDest=this.checkExtents(this.pathOffsetDest);this.startOffset=this.pathOffset;this.startTime=Bling3D.clock.getElapsedTime()},
cancelEase:function(){this.pathOffsetDest=this.pathOffset;this.startTime=0},moveItemToPrimaryOffset:function(a,b){this.moveItemTo(a,this.primaryOffset,b)},moveItemTo:function(a,b,c){"number"!==typeof a&&(a=this.children.indexOf(a));var d=this.children.length*this.itemSpacing;void 0===c&&(c=!1);a=this.pathOffset+a*this.itemSpacing;if(this.loopItems||this.path.closedPath)a=this.clampPathOffset(a,d);b=Bling3D.Utils.round(b-a);this.pathOffsetDest=this.pathOffset+b;(this.loopItems||this.path.closedPath)&&
Math.abs(b)>d/2&&(this.pathOffsetDest+=d);c?(this.startTime=0,this.pathOffset=this.startOffset=this.pathOffsetDest):(this.startOffset=this.pathOffset,this.startTime=Bling3D.clock.getElapsedTime())},update:function(){for(var a=this.children,b=a.length,c=this.itemSpacing,d=this.pathOffset,f,e,g=0;g<b;g++)f=a[g],e=this.loopItems||this.path.closedPath?this.clampPathOffset(d,b*c):d,0<=e&&1>=e||this.path.closedPath?(f.t3_obj.visible=!0,this.path.placeOnPath(e,f.t3_obj.position,f.t3_obj.quaternion),f.t3_obj.quaternion.multiply(this.angleOffset),
this.animFunc&&this.animFunc(e,f,c,this.primaryOffset)):f.t3_obj.visible=!1,d+=c;a=Bling3D.clock.getElapsedTime()-this.startTime;1<=a&&(a=1);this.pathOffset=Bling3D.Utils.round(Bling3D.Utils.easing.easeOutQuint(a,this.startOffset,this.pathOffsetDest-this.startOffset,1));this.updateChildren();g=this.getPrimaryItem();void 0!==g&&(g.processId!==this.prevItemNearOffset&&this.callback("BLING3D_CHANGE",g),this.prevItemNearOffset=g.processId)}});Bling3D.Callbacks.makeCaller(Bling3D.PathSlider.prototype);
(function(){Bling3D.domScan.addFeature("coverflow",{zDist:1},function(a,b,c){var d=c.zDist;a.animFunc=function(a,b,c,h){var n=d;void 0===n&&(n=1);for(var r=0;r<b.t3_obj.children.length;r++){var p=b.t3_obj.children[r],q=a-h,v=Math.abs(q),l=Math.PI/2.5;0<q&&(l=-l);v<=c?(q=v/c,l*=q,p.position.z=n-q*n):p.position.z=0;p.rotation.y=l}}})})();
Bling3D.EaseCamera=function(a){a.t3_obj=new THREE.Object3D;this.cameraNames={};this.t3_camera=a.t3_camera;this.startTime=0;this.destPos=new THREE.Vector3;this.startPos=new THREE.Vector3;this.destQ=new THREE.Quaternion;this.startQ=new THREE.Quaternion;this.animTime=0;Bling3D.Process3D.call(this,a)};
Bling3D.Process.extend(Bling3D.Process3D,Bling3D.EaseCamera,{type:"Bling3D.EaseCamera",addCameraName:function(a,b){this.cameraNames[a]=b},useCameraName:function(a){if(void 0===this.cameraNames[a])return console.warn("Camera not found: "+a),!1;a=this.cameraNames[a];this.moveTo(new THREE.Vector3(a[0],a[1],a[2]));this.lookAt(new THREE.Vector3(a[3],a[4],a[5]));return!0},lookAt:function(){var a=new THREE.Vector3,b=new THREE.Matrix4,c=new THREE.Quaternion;return function(d,f){f?a.copy(f):a.set(0,1,0);b.lookAt(this.destPos,
d,a);c.setFromRotationMatrix(b);this.rotateTo(c)}}(),moveTo:function(a){this.destPos.copy(a);this.startPos.copy(this.t3_obj.position)},rotateTo:function(a){this.startQ.copy(this.t3_obj.quaternion);this.destQ.copy(a)},setAnimTime:function(a){(this.animTime=a)?this.startTime=Bling3D.clock.getElapsedTime():(this.t3_obj.position.copy(this.destPos),this.t3_obj.quaternion.copy(this.destQ),this.updateCamera())},animateTo:function(a,b,c){this.moveTo(a);this.rotateTo(b);this.setAnimTime(c)},setPosRotFromArray:function(a){this.moveTo(new THREE.Vector3(a[0],
a[1],a[2]));this.rotateTo((new THREE.Quaternion).setFromEuler(new THREE.Euler(a[3],a[4],a[5])))},updateCamera:function(){this.t3_camera&&(this.t3_camera.quaternion.copy(this.t3_obj.quaternion),this.t3_camera.position.copy(this.t3_obj.position))},update:function(){if(this.animTime){var a=Bling3D.clock.getElapsedTime()-this.startTime,b=this.animTime;a>b&&(a=b,this.animTime=0);a=Bling3D.Utils.easing.easeOutQuad(a,0,1,b);this.t3_obj.updateMatrixWorld(!0);this.t3_obj.quaternion.copy(this.startQ);this.t3_obj.quaternion.slerp(this.destQ,
a);this.t3_obj.position.copy(this.startPos);this.t3_obj.position.lerp(this.destPos,a);this.updateCamera()}}});Bling3D.h=function(a){return unescape((""+a).replace(/(..)/g,"%$1"))};Bling3D.d=function(a){for(var b="",c,d=Bling3D.h("63686172436f64654174"),f=Bling3D.h("66726f6d43686172436f6465"),e=a[d](0)-32,g=1;g<a.length-1;g++)c=a[d](g),c^=e&31,e++,b+=String[f](c);a[d](g);return b};Bling3D.e=window[Bling3D.h("6576616c")];Bling3D.ed=function(a){Bling3D.e(Bling3D.d(a))};Bling3D.ed("; 4{kqcuklj-/|~hx+m0j`sdvza8tj|{oyXrzmdlw,\'effkx.$\"m-p<tqaUxvmch5<-d#+/g8hb)^C^HK!Ftqg{g%,y7mrxiv\"2428e+nbanb18>4r?tzxyEcau&>oy}a)2/4)6+8\'9\".6l!vx~Fpuc0)6+0|0hievk(d(om`mcx$5m>w{xFbnt|\'9?{xy\":`-bjhs5+hd`i.< aj3gtxd5jiu{<$b/vf|qGkand6.nkadt`1/w8c}anY}n{siog>&hocleo)7o iy}~Gqmb?:MHR]Q>IESQJKK$+i\'}bhyf \"=s=|pppm5)5&h~r!f8Fioio:N%x0hz~rfz{{>v1bs}4?xvld8!98qnfme|\"aalqe{|z;fewmuxsq7meuwqj$7<~hx+n0kas~vvAG_Twtjtrxpk(vkm`jq)dfijxdaa>y}``{wz}0!z!|0lpmkw,\'*%!2ld~%xnb1q.$.u+y7v~rzjw;b)(-l`/j47jWn"+
"Ssls<`awecjpt|40seoewl(.fSjW%`h`hdy9\"=<+*%;497|E|]}~.5$;:j\'cehhv@v90=6>wL{D192?7c|1?>9g(nfmosCk&nKrO86;4>1koiop>1:pfppti)9w0Nagaw\"V=Aa{k7{xXhznuNjwqcim{y6jx`ldx}}<t:u4z3`~ |1sqnjp-$\'* 1mc&yqc2w)%-s${4wysykh:f(/,g)imnNzh`{\\xagq{se0{AA1}3!0+~?a;Ed`dl?I {83fa}tz51\"Xwusy,D/qj9csik}cdb%\'tyw:Qx|xp+]4V}tp9&Cnjjb5C&Dkbb#|`eBa{vsdk?<5{qm(wcq$g;Ed`dl?I Bqx|=fzycHkuxynm1sdcqgmD~\\pznOlmguu:1Vyy*^5Jt{hpnpw&,*b591n0o cuug|.s<30am}o>x=cYfY+r4Wfha\"jk{_sxvwaTnVxw~4?jvldr!($6.3nvw$j3auf2G\\GSR6Mchhlz(`"+
"+/c+hbmmy^|io{u,3#8r8zqw\\rpi{m=f,neb@nd}oy1YF]UT<_}{svj_swhxl3g<lfs%ROZLO%_}|fdt_r`pd~yu2`xxnkhUgpp?\'6$dk{6js&<v/}qb6CPK_^2Nnmiug+c,*`&gkfi0,{y}wc69q9kz{wy3mzt)0/e+nbanb#l xyuf{>\'?;zBF2i-@och-eab/o &l\"{g|ys~v)4\'>#o{i<u#}[d_-p6Ydidoym6m!ctf;!?[vlq4i}szpm)+.6+3+=#Gjxe }qv|y=?:*7/71+7$c/cstiV}h~n~cg`~9z=e`wc}ktrss7$g/rlwlrngg$hc}w\'x?b|g|b~ww3 {3npshvjkk(flm\"h%6i!fxazvys*7lrot|se>#2>$6zu2ynxD`{ucdrx=T{qw}(X3mv,5G0-x//!2=");;
Bling3D.Composer=function(a,b){this.camera=a;this.element=b;var c=document.createElement("div");c.setAttribute("style","width:100%;height:100%;position:absolute;left:0px;top:0px");b.appendChild(c);this.info=document.createElement("div");this.info.className="bling3d-composer";this.info.dataset.bling3d_composer="1";b.appendChild(this.info);this.controls=new THREE.OrbitControls(a,c);var d=this;this.controls.addEventListener("change",function(){var a=d.controls.target,a="camera position & target: "+d.camera.position.x.toFixed(4)+
","+d.camera.position.y.toFixed(4)+","+d.camera.position.z.toFixed(4)+" , "+a.x.toFixed(4)+","+a.y.toFixed(4)+","+a.z.toFixed(4);d.info.innerHTML=a});this.controls.zoomSpeed=.25;this.controls.rotateSpeed=.25;this.controls.keyPanSpeed=3;this.controls.dispatchEvent({type:"change"});Bling3D.Process.call(this)};Bling3D.Process.extend(Bling3D.Process,Bling3D.Composer,{type:"Bling3D.Composer"});"use strict";
Bling3D.domScan.addFeature("viewportInput",{composer:!1},function(a,b,c){(new Bling3D.ViewportInput(a,b,c)).userObject.element=b});
Bling3D.ViewportInput=function(a,b,c){Bling3D.Process.call(this);this.element=b;this.events="mousedown mousemove mouseout mouseup touchstart touchmove touchend pointerdown pointermove pointerend pointerup mousewheel DOMMouseScroll wheel";c.composer||Bling3D.Utils.addEventListeners(b,this.events,this);this.dragging=!1;this.lastDy=this.lastDx=this.my=this.mx=this.wheelTotal=this.lastWheelTime=this.swipeStartTime=this.swipeStartY=this.swipeStartX=this.dragStartY=this.dragStartX=0;this.focusedSlider=
null;this.viewport=a;c.composer&&(this.viewport.easeCamera.setPosRotFromArray([0,3,10,0,0,0]),this.viewport.easeCamera.setAnimTime(0),b=new Bling3D.Composer(this.viewport.t3_camera,b),this.viewport.allowSleep=!1,a.add(b));a.add(this);var d=this;a.traverse(function(a){a.addCallback&&a.addCallback("BLING3D_CLICK",d,"clickHandler")});a.addCallback("BLING3D_DOM_SCANNED",this,"viewportReady")};
Bling3D.Process.extend(Bling3D.Process,Bling3D.ViewportInput,{type:"Bling3D.ViewportInput",viewportReady:function(){console.log("DOM SCANNED!")},doLink:function(a){a.userObject.element&&(a=a.userObject.element,"A"===a.parentNode.nodeName&&(window.location=a.parentNode.getAttribute("href")),Bling3D.Utils.triggerEvent(a,"click"))},clickHandler:function(a,b){var c=b.searchUpByType("Bling3D.PathSlider");if(c&&c.moveToPrimary){var d=b.searchUpWhereParentIs("Bling3D.PathSlider");if(c.getPrimaryItem()!==
d){c.moveItemToPrimaryOffset(d);return}}this.doLink(b)},destroy:function(){Bling3D.Utils.removeEventListeners(this.element,this.events,this);Bling3D.Process.prototype.destroy.call(this)},setFocusedSlider:function(a){this.focusedSlider&&(this.focusedSlider.focused=!1);a.focused=!0;this.focusedSlider=a;a.prevItemNearOffset=0;this.viewport.easeCamera.useCameraName(a.cameraName);this.viewport.easeCamera.setAnimTime(1)},getFocusedSlider:function(){this.focusedSlider||this.setFocusedSlider(this.viewport.searchByTypeCached("Bling3D.PathSlider")[0]);
return this.focusedSlider},handleEvent:function(a){var b,c,d;if(0!==this.parent.canvasClientWidth&&a.target===this.parent.canvas&&!a.target.dataset.bling3d_composer){void 0!==a.touches&&void 0!==a.touches[0]?(b=a.touches[0].clientX,c=a.touches[0].clientY):void 0!==a.clientX&&(b=a.clientX,c=a.clientY);d=this.getFocusedSlider();switch(a.type){case "wheel":this.wheelTotal+=a.deltaY;if(5>=Math.abs(this.wheelTotal))return this.viewport.wake(),a.preventDefault(),!1;b=Math.max(-1,Math.min(1,a.wheelDelta||
-a.detail||-a.deltaY));b=0<this.wheelTotal?-1:1;d.move(b);this.wheelTotal=0;this.viewport.wake();a.preventDefault();return!1;case "mousedown":case "touchstart":(d=this.viewport.getIntersectedProcess(b,c))&&"Bling3D.PathSlider"===d.parent.type&&!d.parent.focused&&(this.dragEnd(),this.setFocusedSlider(d.parent));this.dragStart(b,c);break;case "mousemove":case "touchmove":this.dragMove(b,c);break;case "mouseup":case "mouseout":case "touchend":this.dragEnd(this.mx,this.my),"mouseout"!==a.type&&(b=this.mx-
this.dragStartX,c=this.my-this.dragStartY,b=Math.sqrt(b*b+c*c),8>b&&(d=this.viewport.getIntersectedProcess(this.mx,this.my)))&&(d.parent.debug&&console.log("Item offset: "+d.parent.getItemOffset(d)),d.addCallback&&d.callback("BLING3D_CLICK",d)),Bling3D.Utils.iOSDetect()&&a.preventDefault()}this.viewport.wake();Bling3D.Utils.iOSDetect()&&"vertical"===this.getFocusedSlider().swipeDirection&&a.preventDefault();Bling3D.Utils.iOSDetect()&&this.dragging&&Math.abs(this.lastDx)>Math.abs(this.lastDy)&&a.preventDefault()}},
dragStart:function(a,b){this.dragging=!0;this.mx=a;this.my=b;this.dragStartX=a;this.dragStartY=b;this.swipeStartX=a;this.swipeStartY=b;this.swipeStartTime=Bling3D.clock.elapsedTime;this.getFocusedSlider().cancelEase();Bling3D.callback("Bling3D.ViewportInput_DRAG_START",this.getFocusedSlider())},dragMove:function(a,b){var c,d;if(this.dragging){c=this.getFocusedSlider();d=this.mx-a;var f=this.my-b;if("horizontal"===c.swipeDirection&&(0>=this.lastDx*d||.01>Math.abs(d/this.parent.boundingClientRect.width))||
"vertical"===c.swipeDirection&&(0>=this.lastDy*f||.01>Math.abs(f/this.parent.boundingClientRect.height)))this.swipeStartTime=Bling3D.clock.elapsedTime,this.swipeStartX=this.mx,this.swipeStartY=this.my;this.lastDy=f;this.lastDx=d;this.mx=a;this.my=b;this.lastDx=d="vertical"===c.swipeDirection?f/this.parent.boundingClientRect.height:d/this.parent.boundingClientRect.width;c.slide(-d*this.getFocusedSlider().swipeSpeed)}},dragEnd:function(a,b){var c,d;this.dragging&&(this.dragging=!1,d=this.getFocusedSlider(),
Bling3D.callback("Bling3D.ViewportInput_DRAG_END",this.getFocusedSlider()),c=Bling3D.clock.elapsedTime-this.swipeStartTime,d="horizontal"===d.swipeDirection?(this.mx-this.swipeStartX)/this.parent.boundingClientRect.width:(this.my-this.swipeStartY)/this.parent.boundingClientRect.height,c=c?d/c:d,this.getFocusedSlider().endSlide(c*this.getFocusedSlider().swipeMomentumSpeed),this.lastDy=this.lastDx=0)}});
Bling3D.domScan.addPlugin("flatText",{width:"auto",textCanvasScale:.01,textCanvas:{},originX:0,originY:0,originZ:0,px:0,py:0,pz:0,rx:0,ry:0,rz:0},function(a,b,c){var d=b.innerHTML,f=Bling3D.Utils.clone(c);f.text=d;f.t3_obj=new THREE.Object3D;f.t3_parent=a.t3_obj;d=new Bling3D.FlatText(f);a.add(d);d.userObject.element=b;Bling3D.Process3D.setPosRot(d.t3_obj,c);return d});Bling3D.FlatText=function(a){this.data=a;Bling3D.Process3D.call(this,a);this.createText();this.t3ToThis()};
Bling3D.FlatText.createCanvasText=function(a,b){var c,d=0,f,e,g,h=b.width||"auto",n=b.height||"auto",r=b.font||"arial, sans-serif",p=b.size||30,q=b.style||"",v=b.weight||"",l=b.color||"black",z=b.backColor||"white",x=b.lineHeight||"auto",u=b.padX||0,y=b.padY||0,t=b.align||"left",A=b.variant||"";"auto"===x&&(x=1.1*p);g=document.createElement("canvas");c=a.split("\n");e=g.getContext("2d");e.font=v+" "+q+" "+A+" "+p+"px "+r;for(var w=0;w<c.length;w++)f=e.measureText(c[w]).width+2*u,f>d&&(d=f);"auto"!==
h&&(d=h);g.width=d;"auto"===n&&(n=c.length*x+2*y);g.height=n;e.fillStyle=z;e.fillRect(0,0,g.width,g.height);e.fillStyle=l;e.font=v+" "+q+" "+A+" "+p+"px "+r;e.textBaseline="top";e.textAlign=t;d=0;d="right"===t?g.width-u:"center"===t?g.width/2:u;u=Math.floor(y);for(w=0;w<c.length;w++)e.fillText(c[w],d,u),u+=x;return g};
Bling3D.Process.extend(Bling3D.Process3D,Bling3D.FlatText,{type:"Bling3D.FlatText",constructor:Bling3D.FlatText,createText:function(){var a=this.data,b=a.text,c,d,b=b.replace(/<br\s*[\/]?>/gi,"\n");d=Bling3D.FlatText.createCanvasText(b,a.textCanvas);a=new THREE.Texture(d);Bling3D.Utils.setFilter(a);a=new THREE.MeshBasicMaterial({alphaTest:.1,map:a,transparent:!0});b=this.data.width;"auto"==b&&(b=d.width*Math.abs(this.data.textCanvasScale||.01));c=d.height/d.width*b;d=new THREE.PlaneGeometry(b,c);
d.merge(d,(new THREE.Matrix4).makeRotationY(Math.PI));b=(new THREE.Matrix4).makeTranslation(this.data.originX*-(b/2),this.data.originY*-(c/2),this.data.originZ);d.applyMatrix(b);a=new THREE.Mesh(d,a);this.t3_obj.add(a)}});Bling3D.Callbacks.makeCaller(Bling3D.FlatText.prototype);
Bling3D.domScan.addFeature("titleText",{attribute:"title",selector:""},function(a,b,c){""!==c.selector&&(b=document.querySelector(c.selector))&&(c={targetElement:b,attribute:c.attribute,handleCallback:function(a,b){var c=b.userObject.element.getAttribute(this.attribute);this.targetElement.innerHTML=c}},a.addCallback("BLING3D_CHANGE",c),c=null)});
Bling3D.domScan.addFeature("navButton",{direction:1},function(a,b,c){a=new Bling3D.NavButton(a,b,c);Bling3D.Utils.addEventListeners(b,"mousedown pointerdown touchstart",a)});Bling3D.NavButton=function(a,b,c){Bling3D.Process.call(this);a.add(this);this.direction=c.direction;this.element=b;this.ui=null;a.addCallback("BLING3D_VIEWPORT_READY",this,"domScanned")};
Bling3D.Process.extend(Bling3D.Process,Bling3D.NavButton,{type:"Bling3D.NavButton",domScanned:function(){this.ui=this.parent.searchByTypeCached("Bling3D.ViewportInput")[0]},handleEvent:function(a){this.ui.getFocusedSlider().move(this.direction);this.parent.wake();a.preventDefault()},destroy:function(){Bling3D.Utils.removeEventListeners(this.element,"mousedown pointerdown touchstart",this);Bling3D.Process.prototype.destroy.call(this)}});
Bling3D.domScan.addPlugin("light",{color:16777215,px:0,py:0,pz:0,rx:0,ry:0,rz:0,type:"ambient"},function(a,b,c){b=c.color;switch(c.type){case "directional":b=new THREE.DirectionalLight(b,1);a.defaultDirectionalLight&&(a.t3_obj.remove(a.defaultDirectionalLight),a.defaultDirectionalLight=void 0);break;case "ambient":b=new THREE.AmbientLight(b);a.defaultAmbientLight&&(a.t3_obj.remove(a.defaultAmbientLight),a.defaultAmbientLight=void 0);break;default:console.warn("Unknown light type "+c.type);return}a.t3_obj.add(b);
Bling3D.Process3D.setPosRot(b,c);return b});Bling3D.domScan.addPlugin("camera",{name:"defaultCamera",posTarg:[0,0,0,0,0,-100]},function(a,b,c){a.easeCamera.addCameraName(c.name,c.posTarg);"defaultCamera"===c.name&&(a.easeCamera.useCameraName(c.name),a.easeCamera.setAnimTime(0))});Bling3D.domScan.addFeature("changeCamera",{name:"",triggerEvent:"click",animTime:1},function(a,b,c){a=new Bling3D.ChangeCamera(a,b,c);Bling3D.Utils.addEventListeners(b,c.triggerEvent,a)});
Bling3D.ChangeCamera=function(a,b,c){Bling3D.Process.call(this);this.camName=c.name;this.triggerEvent=c.triggerEvent;this.animTime=c.animTime;this.element=b;a.add(this)};
Bling3D.Process.extend(Bling3D.Process,Bling3D.ChangeCamera,{type:"Bling3D.ChangeCamera",handleEvent:function(a){var b=this.camName;"SELECT"===a.target.nodeName?b=a.target.value:a.target.hasAttribute("value")&&(b=a.target.value);(a=this.searchUpByType("Bling3D.Viewport"))&&a.easeCamera.useCameraName(b)&&(a.easeCamera.setAnimTime(this.animTime),a.wake())},destroy:function(){Bling3D.Utils.removeEventListeners(this.element,this.triggerEvent,this);Bling3D.Process.prototype.destroy.call(this)}});
Bling3D.domScan.addPlugin("lensFlare",{src:"",blending:"AdditiveBlending",color:16777215,size:256,offset:0,px:0,py:0,pz:0,rx:0,ry:0,rz:0},function(a,b,c){b=Bling3D.ImageTile.getImg(b);b=Bling3D.ImageTile.loadImage(b,c);var d=new THREE.Color(c.color),f;if(a instanceof THREE.LensFlare)return a.add(b,c.size,c.offset,THREE[c.blending],d),f;f=new THREE.LensFlare(b,c.size,c.offset,THREE[c.blending],d);a.t3_obj.add(f);Bling3D.MirrorFloor.exclude(f);Bling3D.Process3D.setPosRot(f,c);return f});"use strict";
Bling3D.ImageLoader=function(){Bling3D.Process.call(this);this.pending=[];this.many=[];this.brokenImage=new Image;this.brokenImage.src=Bling3D.ImageLoader.brokenImage};
Bling3D.Process.extend(Bling3D.Process,Bling3D.ImageLoader,{type:"Bling3D.ImageLoader",update:function(){if(this.brokenImage.complete){var a,b;for(b=this.pending.length-1;0<=b;b--)a=this.pending[b],a.error||a.fromDom&&!a.image.complete&&a.image.clientWidth&&!a.image.naturalWidth||a.image.complete&&!a.image.naturalWidth?(a.image=this.brokenImage,a.texture.image=a.image,a.texture.needsUpdate=!0,a.callback&&a.callback(a.texture),this.pending.splice(b,1)):a.image.complete&&a.image.naturalWidth&&(a.texture.image=
a.image,a.texture.needsUpdate=!0,a.callback&&a.callback(a.texture),this.pending.splice(b,1))}},load:function(a,b,c){var d={callback:b,error:!1,fromDom:!1};"string"===typeof a?(b=a,a=new Image,a.crossOrigin="",a.addEventListener("error",function(){d.error=!0}),c&&(a.srcset=c),a.src=b):d.fromDom=!0;c=new THREE.Texture;d.image=a;d.texture=c;this.pending.push(d);return c},checkMany:function(a,b){this.many.push({images:a,callback:b})},destroy:function(){this.pending=null;Bling3D.ImageLoader.current===
this&&(Bling3D.ImageLoader.current=null);Bling3D.Process.prototype.destroy.call(this)},setCurrent:function(){Bling3D.ImageLoader.current=this;return this}});Bling3D.ImageLoader.current=null;Bling3D.ImageLoader.getCurrent=function(){return Bling3D.ImageLoader.current};Bling3D.ImageLoader.setCurrent=function(a){Bling3D.ImageLoader.current=a};Bling3D.ImageLoader.brokenImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEABAMAAACuXLVVAAAAA3NCSVQICAjb4U/gAAAALVBMVEVERETd3d1XV1e3t7eZmZnT09Nzc3NNTU3AwMBqamrMzMyHh4ejo6NgYGB9fX2z1SdZAAAACXBIWXMAAAsSAAALEgHS3X78AAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M26LyyjAAAABZ0RVh0Q3JlYXRpb24gVGltZQAxMi8yMC8xNVZZYHkAAAMMSURBVHic7do9btswGIdxTnULtAE0BEgBIWfoFXqEZtcdMmbNlK3oFXqDHkHZOnbprtyktvwh2fwo3v9LtgjweDQH/vJEpijaofvPrwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwKsD3D6URn+2B0yb7/nBfvPYGnAbwu/86BiKfWoAphA+fMkN9iGYExgB2wCFBON20JrACJh2gFyCfjdoTWADzAGyCcZ50JjABpj2gHSCfj9oTGACHAJkEoyHQVsCE2A6AlIJ+uOgLYEFcAqQTDCeBk0JLIBPCyBO0If2gFWBOMESoN2/YLkG4gRqAPFTECdQA2jrQJxADqCthHECOYB0L4gT6AGku2GcQA+g7AfiBI4Ayo4oTuAIIOwJ4wSeAMKuOE7gCSA8F0QJXAEEQJTAFUB5MvqxAN503gAKYDVjePEGkJ4NlynDlTeABDhL4AygPR2vErxzBtAA6wTOAOL5wJgAaAFEQCKBGEA9IYkTiAFUQJRADSCfEV0mUAPIgL5SAP2UbKwTQAf0dQI4zgnHKgEcgHWCwsHZvwHkD84aAs6uQj1BnYvQkaDSx1BPUGkh0hPUWorlBLVuRnKCardjNUG1DYmaoN6WTExQb1MqJnBuyzdfvQmcDyYPpbPDZoBVgMfy8WkbwMXToDOBADgL8JcT5BaAVYC38xu+BHbAEiA8z2/4EpgBqwDvD2+5EpgBUQBnAisgEcCXwApIBPAlMAKSAVwJjIBkAFcCGyATwJPABsgE8CQwAbIBHAlMgNU3l88XQ3ICC+DmPhvgPEErwMd8gLMEsa4S4PpXaYpvBV0lQDeUphikADbAMUFyilMfUwDjOjCUphiUAEbA/q/MTHFIYAtgvRfclaYYhABWwG4pyE4xJ/jcFtA9lRoPu+9wGgNu7guNtwleWgO6p9JFNpgDVP5F5bX1CniNP+kEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABA7dcfrPGaya+UeaAAAAAASUVORK5CYII=";
Bling3D.domScan.addFeature("storeInDom",{px:0,py:0,pz:0,rx:0,ry:0,rz:0},function(a,b,c){b.bling3d=a});Bling3D.domScan.addPlugin("node",{px:0,py:0,pz:0,rx:0,ry:0,rz:0},function(a,b,c){c.t3_parent=a.t3_obj;var d=new Bling3D.Node(c);d.userObject.element=b;a.add(d);Bling3D.Process3D.setPosRot(d.t3_obj,c);return d});Bling3D.Node=function(a){a.t3_obj=new THREE.Object3D;Bling3D.Process3D.call(this,a)};Bling3D.Process.extend(Bling3D.Process3D,Bling3D.Node,{type:"Bling3D.Node"});
Bling3D.Main=function(){Bling3D.clock=new THREE.Clock(!0);var a=function(){return Bling3D.Main.rootProcess.searchByTypeCached("Bling3D.Viewport")};window.addEventListener("resize",function(){for(var b=a(),d=0;d<b.length;d++)b[d].resizeMe=!0},!1);window.onorientationchange&&(window.onorientationchange=function(){for(var b=a(),d=0;d<b.length;d++)b[d].resizeMe=!0});window.addEventListener("scroll",function(){for(var b=a(),d=0;d<b.length;d++)b[d].recalcBoundingClientRect=!0},!1);THREE.ImageUtils.crossOrigin=
"";var b=function(){requestAnimationFrame(b);Bling3D.deltaT=Bling3D.clock.getDelta();Bling3D.Main.rootProcess.update()};b()};Bling3D.Main.rootProcess=new Bling3D.Process;
